{"is_source_file": true, "format": "bash shell script", "description": "This file is a shell script that applies the PostgreSQL database schema for the ConnectHuddle application. It creates extensions, tables, indexes, functions, and triggers necessary for the application's database, ensuring idempotency and consistency.", "external_files": ["db_connection.txt"], "external_methods": ["cat", "echo", "example: -cat", "psql command invoked as ${CONN} with -v and -c options"], "published": [], "classes": [], "methods": [{"name": "run_sql", "description": "A helper function to execute a SQL statement with error stopping enabled."}], "calls": ["cat", "echo", "${CONN} -v ON_ERROR_STOP=1 -c", "psql", "CREATE EXTENSION IF NOT EXISTS pgcrypto;", "CREATE TABLE IF NOT EXISTS users", "CREATE UNIQUE INDEX IF NOT EXISTS users_email_ci_uq", "CREATE TABLE IF NOT EXISTS huddles", "CREATE UNIQUE INDEX IF NOT EXISTS huddles_join_code_uq", "CREATE INDEX IF NOT EXISTS huddles_host_user_id_idx", "CREATE INDEX IF NOT EXISTS huddles_status_created_at_idx", "CREATE TABLE IF NOT EXISTS huddle_participants", "CREATE UNIQUE INDEX IF NOT EXISTS huddle_participants_huddle_user_uq", "CREATE INDEX IF NOT EXISTS huddle_participants_huddle_joined_idx", "CREATE INDEX IF NOT EXISTS huddle_participants_user_joined_idx", "CREATE TABLE IF NOT EXISTS chat_messages", "CREATE INDEX IF NOT EXISTS chat_messages_huddle_created_idx", "CREATE INDEX IF NOT EXISTS chat_messages_sender_created_idx", "CREATE INDEX IF NOT EXISTS chat_messages_metadata_gin_idx", "CREATE TABLE IF NOT EXISTS notifications", "CREATE INDEX IF NOT EXISTS notifications_user_created_idx", "CREATE INDEX IF NOT EXISTS notifications_user_unread_idx", "CREATE INDEX IF NOT EXISTS notifications_data_gin_idx", "DO $$ BEGIN ... END $$;"], "search-terms": ["apply_schema", "PostgreSQL schema", "database initialization script", "schema creation", "idempotent SQL script"], "state": 2, "file_id": 8, "knowledge_revision": 18, "git_revision": "3f072b5781393558383d4be53558c4f8c30e91d7", "hash": "ae42b1ccce8c58b6c42f306a7a31b482", "format-version": 4, "code-base-name": "huddle_database", "filename": "huddle_database/apply_schema.sh", "revision_history": [{"18": "3f072b5781393558383d4be53558c4f8c30e91d7"}]}